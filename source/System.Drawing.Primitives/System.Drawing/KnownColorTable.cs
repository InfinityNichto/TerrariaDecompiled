namespace System.Drawing;

internal static class KnownColorTable
{
	public static readonly uint[] s_colorValueTable = new uint[176]
	{
		0u, 10u, 2u, 9u, 12u, 15u, 16u, 21u, 22u, 20u,
		18u, 1u, 17u, 13u, 14u, 26u, 11u, 3u, 19u, 24u,
		23u, 4u, 7u, 0u, 5u, 6u, 8u, 16777215u, 4293982463u, 4294634455u,
		4278255615u, 4286578644u, 4293984255u, 4294309340u, 4294960324u, 4278190080u, 4294962125u, 4278190335u, 4287245282u, 4289014314u,
		4292786311u, 4284456608u, 4286578432u, 4291979550u, 4294934352u, 4284782061u, 4294965468u, 4292613180u, 4278255615u, 4278190219u,
		4278225803u, 4290283019u, 4289309097u, 4278215680u, 4290623339u, 4287299723u, 4283788079u, 4294937600u, 4288230092u, 4287299584u,
		4293498490u, 4287609999u, 4282924427u, 4281290575u, 4278243025u, 4287889619u, 4294907027u, 4278239231u, 4285098345u, 4280193279u,
		4289864226u, 4294966000u, 4280453922u, 4294902015u, 4292664540u, 4294506751u, 4294956800u, 4292519200u, 4286611584u, 4278222848u,
		4289593135u, 4293984240u, 4294928820u, 4291648604u, 4283105410u, 4294967280u, 4293977740u, 4293322490u, 4294963445u, 4286381056u,
		4294965965u, 4289583334u, 4293951616u, 4292935679u, 4294638290u, 4292072403u, 4287688336u, 4294948545u, 4294942842u, 4280332970u,
		4287090426u, 4286023833u, 4289774814u, 4294967264u, 4278255360u, 4281519410u, 4294635750u, 4294902015u, 4286578688u, 4284927402u,
		4278190285u, 4290401747u, 4287852763u, 4282168177u, 4286277870u, 4278254234u, 4282962380u, 4291237253u, 4279834992u, 4294311930u,
		4294960353u, 4294960309u, 4294958765u, 4278190208u, 4294833638u, 4286611456u, 4285238819u, 4294944000u, 4294919424u, 4292505814u,
		4293847210u, 4288215960u, 4289720046u, 4292571283u, 4294963157u, 4294957753u, 4291659071u, 4294951115u, 4292714717u, 4289781990u,
		4286578816u, 4294901760u, 4290547599u, 4282477025u, 4287317267u, 4294606962u, 4294222944u, 4281240407u, 4294964718u, 4288696877u,
		4290822336u, 4287090411u, 4285160141u, 4285563024u, 4294966010u, 4278255487u, 4282811060u, 4291998860u, 4278222976u, 4292394968u,
		4294927175u, 4282441936u, 4293821166u, 4294303411u, 4294967295u, 4294309365u, 4294967040u, 4288335154u, 15u, 20u,
		16u, 27u, 28u, 30u, 29u, 4284887961u
	};

	public static ReadOnlySpan<byte> ColorKindTable => new byte[176]
	{
		2, 0, 0, 0, 0, 0, 0, 0, 0, 0,
		0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
		0, 0, 0, 0, 0, 0, 0, 1, 1, 1,
		1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
		1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
		1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
		1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
		1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
		1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
		1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
		1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
		1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
		1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
		1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
		1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
		1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
		1, 1, 1, 1, 1, 1, 1, 1, 0, 0,
		0, 0, 0, 0, 0, 1
	};

	internal static Color ArgbToKnownColor(uint argb)
	{
		for (int i = 1; i < s_colorValueTable.Length; i++)
		{
			if (ColorKindTable[i] == 1 && s_colorValueTable[i] == argb)
			{
				return Color.FromKnownColor((KnownColor)i);
			}
		}
		return Color.FromArgb((int)argb);
	}

	public static uint KnownColorToArgb(KnownColor color)
	{
		if (ColorKindTable[(int)color] != 0)
		{
			return s_colorValueTable[(int)color];
		}
		return GetSystemColorArgb(color);
	}

	public static uint GetSystemColorArgb(KnownColor color)
	{
		return ColorTranslator.COLORREFToARGB(global::Interop.User32.GetSysColor((byte)s_colorValueTable[(int)color]));
	}
}
